---
title: "25 faces"
author: "Rama"
date: "2022-07-21"
output:
  html_document:
    theme: flatly
    code_folding: hide
    toc: true
    toc_depth: 4
    toc_float: true
    number_sections: true
---
# Preprocessing & Cleaning

```{r preprocessing, warning=FALSE, results=FALSE, messages = FALSE, include = FALSE}

library(tidyverse)
library(jsonlite)
library(jsonlite)
library(dplyr)
library(tidyverse)
library(ggplot2)  
library(ggforce)
library(sjPlot)
library(lme4)
library(lmerTest)
library(interactions)
library(ggpubr)
library(texreg)
library(reghelper)

setwd("/Users/ramat/Desktop/")
```
```{r, warning=FALSE, results=FALSE, messages = FALSE, include = TRUE}

#load full csv data (preprocessed data)
cd <- read.csv("/Users/ramat/Desktop/cleaned.csv")
#recode to do analysis
```
```{r, warning=FALSE, results=FALSE, messages = FALSE, include = FALSE}

cd$fairness[cd$fairness == "Y"] <- 0
cd$fairness[cd$fairness == "N"] <- 1

cd$team_work[cd$team_work == "Y"] <- 0
cd$team_work[cd$team_work == "N"] <- 1

cd$work_in_team[cd$work_in_team == "Y"] <- 0
cd$work_in_team[cd$work_in_team == "N"] <- 1

cd$distrust[cd$work_in_team == "Y"] <- 0
cd$distrust[cd$work_in_team == "N"] <- 1

cd$social[cd$social == "Very liberal"] <- 1
cd$social[cd$social == "Liberal"] <- 2
cd$social[cd$social == "Slightly liberal"] <- 3
cd$social[cd$social == "Moderate"] <- 4
cd$social[cd$social == "Slightly conservative"] <- 5
cd$social[cd$social == "Conservative"] <- 6
cd$social[cd$social == "Very conservative"] <- 7

cd$economic[cd$economic == "Very liberal"] <- 1
cd$economic[cd$economic == "Liberal"] <- 2
cd$economic[cd$economic == "Slightly liberal"] <- 3
cd$economic[cd$economic == "Moderate"] <- 4
cd$economic[cd$economic == "Slightly conservative"] <- 5
cd$economic[cd$economic == "Conservative"] <- 6
cd$economic[cd$economic == "Very conservative"] <- 7

class(cd$social)
class(cd$economic)
cd$PoliticalOrientation <- ((as.numeric(cd$social))+(as.numeric(cd$economic)))/2
  
cd$s1_earn_reward[cd$s1_earn_reward == "Strongly oppose"] <- 1
cd$s1_earn_reward[cd$s1_earn_reward == "Somewhat oppose"] <- 2
cd$s1_earn_reward[cd$s1_earn_reward == "Slightly oppose"] <- 3
cd$s1_earn_reward[cd$s1_earn_reward == "Neutral"] <- 4
cd$s1_earn_reward[cd$s1_earn_reward == "Slightly favor"] <- 5
cd$s1_earn_reward[cd$s1_earn_reward == "Somewhat favor"] <- 6
cd$s1_earn_reward[cd$s1_earn_reward == "Strongly favor"] <- 7

cd$s2_inferior[cd$s2_inferior == "Strongly oppose"] <- 1
cd$s2_inferior[cd$s2_inferior == "Somewhat oppose"] <- 2
cd$s2_inferior[cd$s2_inferior == "Slightly oppose"] <- 3
cd$s2_inferior[cd$s2_inferior == "Neutral"] <- 4
cd$s2_inferior[cd$s2_inferior == "Slightly favor"] <- 5
cd$s2_inferior[cd$s2_inferior == "Somewhat favor"] <- 6
cd$s2_inferior[cd$s2_inferior == "Strongly favor"] <- 7

cd$s3_group_dominate[cd$s3_group_dominate == "Strongly oppose"] <- 7
cd$s3_group_dominate[cd$s3_group_dominate == "Somewhat oppose"] <- 6
cd$s3_group_dominate[cd$s3_group_dominate == "Slightly oppose"] <- 5
cd$s3_group_dominate[cd$s3_group_dominate == "Neutral"] <- 4
cd$s3_group_dominate[cd$s3_group_dominate == "Slightly favor"] <- 3
cd$s3_group_dominate[cd$s3_group_dominate == "Somewhat favor"] <- 2
cd$s3_group_dominate[cd$s3_group_dominate == "Strongly favor"] <- 1

cd$s4_bottom_deserve[cd$s4_bottom_deserve == "Strongly oppose"] <- 7
cd$s4_bottom_deserve[cd$s4_bottom_deserve == "Somewhat oppose"] <- 6
cd$s4_bottom_deserve[cd$s4_bottom_deserve == "Slightly oppose"] <- 5
cd$s4_bottom_deserve[cd$s4_bottom_deserve == "Neutral"] <- 4
cd$s4_bottom_deserve[cd$s4_bottom_deserve == "Slightly favor"] <- 3
cd$s4_bottom_deserve[cd$s4_bottom_deserve == "Somewhat favor"] <- 2
cd$s4_bottom_deserve[cd$s4_bottom_deserve == "Strongly favor"] <- 1

cd$s5_group_equality[cd$s5_group_equality == "Strongly oppose"] <- 1
cd$s5_group_equality[cd$s5_group_equality == "Somewhat oppose"] <- 2
cd$s5_group_equality[cd$s5_group_equality == "Slightly oppose"] <- 3
cd$s5_group_equality[cd$s5_group_equality == "Neutral"] <- 4
cd$s5_group_equality[cd$s5_group_equality == "Slightly favor"] <- 5
cd$s5_group_equality[cd$s5_group_equality == "Somewhat favor"] <- 6
cd$s5_group_equality[cd$s5_group_equality == "Strongly favor"] <- 7

cd$s6_group_equal_unjust[cd$s6_group_equal_unjust == "Strongly oppose"] <- 1
cd$s6_group_equal_unjust[cd$s6_group_equal_unjust == "Somewhat oppose"] <- 2
cd$s6_group_equal_unjust[cd$s6_group_equal_unjust == "Slightly oppose"] <- 3
cd$s6_group_equal_unjust[cd$s6_group_equal_unjust == "Neutral"] <- 4
cd$s6_group_equal_unjust[cd$s6_group_equal_unjust == "Slightly favor"] <- 5
cd$s6_group_equal_unjust[cd$s6_group_equal_unjust == "Somewhat favor"] <- 6
cd$s6_group_equal_unjust[cd$s6_group_equal_unjust == "Strongly favor"] <- 7

cd$s7_act_equalize[cd$s7_act_equalize == "Strongly oppose"] <- 7
cd$s7_act_equalize[cd$s7_act_equalize == "Somewhat oppose"] <- 6
cd$s7_act_equalize[cd$s7_act_equalize == "Slightly oppose"] <- 5
cd$s7_act_equalize[cd$s7_act_equalize == "Neutral"] <- 4
cd$s7_act_equalize[cd$s7_act_equalize == "Slightly favor"] <- 3
cd$s7_act_equalize[cd$s7_act_equalize == "Somewhat favor"] <- 2
cd$s7_act_equalize[cd$s7_act_equalize == "Strongly favor"] <- 1

cd$s8_succeed_equal[cd$s8_succeed_equal == "Strongly oppose"] <- 7
cd$s8_succeed_equal[cd$s8_succeed_equal == "Somewhat oppose"] <- 6
cd$s8_succeed_equal[cd$s8_succeed_equal == "Slightly oppose"] <- 5
cd$s8_succeed_equal[cd$s8_succeed_equal == "Neutral"] <- 4
cd$s8_succeed_equal[cd$s8_succeed_equal == "Slightly favor"] <- 3
cd$s8_succeed_equal[cd$s8_succeed_equal == "Somewhat favor"] <- 2
cd$s8_succeed_equal[cd$s8_succeed_equal == "Strongly favor"] <- 1

cd$SDO <- (((as.numeric(cd$s1_earn_reward))+(as.numeric(cd$s2_inferior))+(as.numeric(cd$s3_group_dominate))+(as.numeric(cd$s4_bottom_deserve))+(as.numeric(cd$s5_group_equality))+(as.numeric(cd$s6_group_equal_unjust))+(as.numeric(cd$s7_act_equalize))+(as.numeric(cd$s8_succeed_equal))))/8

#recode further variables - belief in just world
cd$b1_just_world[cd$b1_just_world == "Strongly disagree"] <- 1
cd$b1_just_world[cd$b1_just_world == "Disagree"] <- 2
cd$b1_just_world[cd$b1_just_world == "Slightly disagree"] <- 3
cd$b1_just_world[cd$b1_just_world == "Slightly Agree"] <- 4
cd$b1_just_world[cd$b1_just_world == "Agree"] <- 5
cd$b1_just_world[cd$b1_just_world == "Strongly agree"] <- 6

cd$b2_people_deserve[cd$b2_people_deserve == "Strongly disagree"] <- 1
cd$b2_people_deserve[cd$b2_people_deserve == "Disagree"] <- 2
cd$b2_people_deserve[cd$b2_people_deserve == "Slightly disagree"] <- 3
cd$b2_people_deserve[cd$b2_people_deserve == "Slightly Agree"] <- 4
cd$b2_people_deserve[cd$b2_people_deserve == "Agree"] <- 5
cd$b2_people_deserve[cd$b2_people_deserve == "Strongly agree"] <- 6

cd$b3_confident_justice[cd$b3_confident_justice == "Strongly disagree"] <- 1
cd$b3_confident_justice[cd$b3_confident_justice == "Disagree"] <- 2
cd$b3_confident_justice[cd$b3_confident_justice == "Slightly disagree"] <- 3
cd$b3_confident_justice[cd$b3_confident_justice == "Slightly Agree"] <- 4
cd$b3_confident_justice[cd$b3_confident_justice == "Agree"] <- 5
cd$b3_confident_justice[cd$b3_confident_justice == "Strongly agree"] <- 6

cd$b4_compensate_injustice[cd$b4_compensate_injustice == "Strongly disagree"] <- 1
cd$b4_compensate_injustice[cd$b4_compensate_injustice == "Disagree"] <- 2
cd$b4_compensate_injustice[cd$b4_compensate_injustice == "Slightly disagree"] <- 3
cd$b4_compensate_injustice[cd$b4_compensate_injustice == "Slightly Agree"] <- 4
cd$b4_compensate_injustice[cd$b4_compensate_injustice == "Agree"] <- 5
cd$b4_compensate_injustice[cd$b4_compensate_injustice == "Strongly agree"] <- 6

cd$b5_injust_exeception[cd$b5_injust_exeception == "Strongly disagree"] <- 1
cd$b5_injust_exeception[cd$b5_injust_exeception == "Disagree"] <- 2
cd$b5_injust_exeception[cd$b5_injust_exeception == "Slightly disagree"] <- 3
cd$b5_injust_exeception[cd$b5_injust_exeception == "Slightly Agree"] <- 4
cd$b5_injust_exeception[cd$b5_injust_exeception == "Agree"] <- 5
cd$b5_injust_exeception[cd$b5_injust_exeception == "Strongly agree"] <- 6

cd$b6_fair_decision[cd$b6_fair_decision == "Strongly disagree"] <- 1
cd$b6_fair_decision[cd$b6_fair_decision == "Disagree"] <- 2
cd$b6_fair_decision[cd$b6_fair_decision == "Slightly disagree"] <- 3
cd$b6_fair_decision[cd$b6_fair_decision == "Slightly Agree"] <- 4
cd$b6_fair_decision[cd$b6_fair_decision == "Agree"] <- 5
cd$b6_fair_decision[cd$b6_fair_decision == "Strongly agree"] <- 6

cd$BJW <- ((as.numeric(cd$b1_just_world)) + (as.numeric(cd$b2_people_deserve))+ (as.numeric(cd$b3_confident_justice)) + (as.numeric(cd$b4_compensate_injustice))  + (as.numeric(cd$b5_injust_exeception)) + (as.numeric(cd$b6_fair_decision)))/6

#gender
cd$gender[cd$gender == "m"] <- 0
cd$gender[cd$gender == "f"] <- 1
cd$gender[cd$gender == "0"] <- 1

#ethic
cd$ethnic[cd$ethnic == "White"] <- 0
cd$ethnic[cd$ethnic == "Asian"] <- 1
cd$ethnic[cd$ethnic == "Other"] <- 1
cd$ethnic[cd$ethnic=="Black-AfrAmr"] <- 1
cd$ethnic[cd$ethnic =="list(value = c(\"White\", \"Black-AfrAmr\"))"] <- 1
cd$ethnic[cd$ethnic =="list(value = c(\"White\", \"Black-AfrAmr\", \"AI-AN\"))"] <- 1
cd$ethnic[cd$ethnic=="list(value = c(\"White\", \"AI-AN\"))"] <- 1
cd$ethnic[cd$ethnic=="list(value = c(\"White\", \"NH-PI\", \"AI-AN\"))"] <- 1
cd$ethnic[cd$ethnic=="list(value = c(\"Asian\", \"Black-AfrAmr\"))"] <- 1
cd$ethnic[cd$ethnic=="list(value = c(\"White\", \"Asian\"))" ] <- 1

#income
cd$income[cd$income == "Less than $10,000"] <- 10000
cd$income[cd$income == "$10,000 to $19,999 "] <- 15000
cd$income[cd$income == "$20,000 to $29,999"] <- 25000
cd$income[cd$income == "$30,000 to $39,999"] <- 35000
cd$income[cd$income == "$40,000 to $49,999"] <- 45000
cd$income[cd$income == "$50,000 to $59,999"] <- 55000
cd$income[cd$income == "$60,000 to $69,999"] <- 65000
cd$income[cd$income == "$70,000 to $79,999"] <- 75000
cd$income[cd$income == "$80,000 to $89,999"] <- 85000
cd$income[cd$income == "$90,000 to $99,999"] <- 95000
cd$income[cd$income == "$100,000 to $124,999"] <- 112500
cd$income[cd$income == "$125,000 to $149,999"] <- 137500
cd$income[cd$income == "$150,000 to $199,999"] <- 175000
cd$income[cd$income == "$200,000 or more"] <- 225000

cd$income_log <- log(as.numeric(cd$income))

#education
cd$edu[cd$edu == "Some high school or less"] <- 1
cd$edu[cd$edu == "Two year college degree"] <- 2
cd$edu[cd$edu == "Some college but no degree"] <- 3
cd$edu[cd$edu == "High school or GED"] <- 4
cd$edu[cd$edu == "Four year college degree"] <- 5
cd$edu[cd$edu == "Graduate degree"] <- 6 

#Marital status
cd$marital[cd$marital ==  "Divorced"] <- 1
cd$marital[cd$marital == "Married"] <- 2
cd$marital[cd$marital == "Seperated"] <- 3
cd$marital[cd$marital == "Widowed"] <- 4
```
## Creating variables for regression
```{r, warning=FALSE, results=FALSE, messages = FALSE, include = TRUE}

#changing up the variables for incomeRatio and trail conditions
#1. non white share/whiteShare: of white(or non-white) / total employee.
cd$nonwhite_share <- ((as.numeric(cd$nNonWhiteTrial))/25)*100
cd$white_share <- ((as.numeric(cd$nWhiteTrial))/25)*100
```
```{r, warning=FALSE, results=FALSE, messages = FALSE, include = FALSE}
variations <- read.csv("C:/Users/ramat/Desktop/variations.csv", sep = ";")

#creating variations for non whites
cd$nw_variations[(cd$incomeRatio == 1) & (cd$trial_condition == 1)] <- 5
cd$nw_variations[cd$incomeRatio == "2" & cd$trial_condition =="1"] <- 6
cd$nw_variations[cd$incomeRatio == "3" & cd$trial_condition =="1"] <- 7
cd$nw_variations[cd$incomeRatio == "4" & cd$trial_condition =="1"] <- 8
cd$nw_variations[cd$incomeRatio == "5" & cd$trial_condition =="1"] <- 9
cd$nw_variations[cd$incomeRatio == "6" & cd$trial_condition =="1"] <- 10
cd$nw_variations[cd$incomeRatio == "7" & cd$trial_condition =="1"] <- 11

cd$nw_variations[cd$incomeRatio == "1" & cd$trial_condition =="2"] <- 10
cd$nw_variations[cd$incomeRatio == "2" & cd$trial_condition =="2"] <- 12
cd$nw_variations[cd$incomeRatio == "3" & cd$trial_condition =="2"] <- 14
cd$nw_variations[cd$incomeRatio == "4" & cd$trial_condition =="2"] <- 16
cd$nw_variations[cd$incomeRatio == "5" & cd$trial_condition =="2"] <- 18
cd$nw_variations[cd$incomeRatio == "6" & cd$trial_condition =="2"] <- 20
cd$nw_variations[cd$incomeRatio == "7" & cd$trial_condition =="2"] <- 22

cd$nw_variations[cd$incomeRatio == "1" & cd$trial_condition =="3"] <- 15
cd$nw_variations[cd$incomeRatio == "2" & cd$trial_condition =="3"] <- 18
cd$nw_variations[cd$incomeRatio == "3" & cd$trial_condition =="3"] <- 21
cd$nw_variations[cd$incomeRatio == "4" & cd$trial_condition =="3"] <- 24
cd$nw_variations[cd$incomeRatio == "5" & cd$trial_condition =="3"] <- 27
cd$nw_variations[cd$incomeRatio == "6" & cd$trial_condition =="3"] <- 30
cd$nw_variations[cd$incomeRatio == "7" & cd$trial_condition =="3"] <- 33

cd$nw_variations[cd$incomeRatio == "1" & cd$trial_condition =="4"] <- 20
cd$nw_variations[cd$incomeRatio == "2" & cd$trial_condition =="4"] <- 24
cd$nw_variations[cd$incomeRatio == "3" & cd$trial_condition =="4"] <- 28
cd$nw_variations[cd$incomeRatio == "4" & cd$trial_condition =="4"] <- 32
cd$nw_variations[cd$incomeRatio == "5" & cd$trial_condition =="4"] <- 36
cd$nw_variations[cd$incomeRatio == "6" & cd$trial_condition =="4"] <- 40
cd$nw_variations[cd$incomeRatio == "7" & cd$trial_condition =="4"] <- 44


cd$nw_variations[cd$incomeRatio == "1" & cd$trial_condition =="5"] <- 25
cd$nw_variations[cd$incomeRatio == "2" & cd$trial_condition =="5"] <- 30
cd$nw_variations[cd$incomeRatio == "3" & cd$trial_condition =="5"] <- 35
cd$nw_variations[cd$incomeRatio == "4" & cd$trial_condition =="5"] <- 40
cd$nw_variations[cd$incomeRatio == "5" & cd$trial_condition =="5"] <- 45
cd$nw_variations[cd$incomeRatio == "6" & cd$trial_condition =="5"] <- 50
cd$nw_variations[cd$incomeRatio == "7" & cd$trial_condition =="5"] <- 55

#Example for the code: the total income share of white (or non-white) employees / whiteShare (or non-white). E.g. trial_condition = 5, we have 10 white and 15 non-white employee -> nonwhite_share = 40%. and in income_ratio = 4, nwhite employees hold 40% of income share (600k/ 1.5m). Then, we will have 40%/40% = 1.
#creating variations for white 
cd$w_variations<- 100-cd$nw_variations
  
#Creating the income Shares in general for NW 
cd$incomeShare_NW<- (cd$nw_variations)/cd$nonwhite_share
round(cd$incomeShare_NW, digits=2)
#Creating the income shares in general for W
cd$incomeShare_W<- (cd$w_variations)/cd$white_share
round(cd$incomeShare_W,digits=2)

#For all variations(income) = 4 this number should be 1. for variations (income) < 4 should be larger than 1, and for trial_condition > 4 should be less than 1.

#numeric team_work
cd$team_work<-as.numeric(cd$team_work)
cd$work_in_team<-as.numeric(cd$work_in_team)
#just participants
X = cd[!duplicated(cd[ , c("subject")]),] #we have 97 final participants

```
```{r, warning=FALSE, results=TRUE, messages = FALSE, include = FALSE}

#create factors 
#cd$incomeShare_NW = as.factor(cd$incomeShare_NW)
#cd$incomeShare_W = as.factor(cd$incomeShare_W)

#cd$incomeShare_NW = factor(cd$incomeShare_NW,levels=rev(levels(cd$incomeShare_NW)))

#cd$incomeShare_W = factor(cd$incomeShare_W, levels=rev(levels(cd$incomeShare_W)))

#cd$edu = as.numeric(cd$edu)

```
```{r, warning=FALSE, results=TRUE, messages = FALSE, include = TRUE}
## summary:cond: white-more; nwmore; equal but for each variation (5)
cd$incomeShare_trial<-cd$nw_variations/cd$nNonWhiteTrial
```
# Main Effect Analysis 
## fairness
```{r, results=FALSE, warning=FALSE, message=FALSE}
m1 <- lme4::glmer(fairness ~ nonwhite_share*incomeShare_trial + (1 | X), cd, family = binomial(link = "logit"))
```
```{r, echo=FALSE}
summary(m1)
```
## team work
```{r, results=FALSE, warning=FALSE, message=FALSE}
m2 <- lme4::glmer(team_work ~ nonwhite_share*incomeShare_trial + (1 | X), cd, family = binomial(link = "logit"))
```
```{r, echo=FALSE}
summary(m2)
```
## work in team
```{r, results=FALSE, warning=FALSE, message=FALSE}
m3 <- lme4::glmer(work_in_team ~ nonwhite_share*incomeShare_trial + (1 | X), cd, family = binomial(link = "logit"))
```
```{r, echo=FALSE}
summary(m3)
```
## distrust
```{r, results=FALSE, warning=FALSE, message=FALSE}
m4 <- lme4::glmer(distrust ~ nonwhite_share*incomeShare_trial + (1 | X), cd, family = binomial(link = "logit"))
```
```{r, echo=FALSE}
summary(m4)
```
## Table with Results
```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

htmlreg(l = list(m1, m2, m3, m4), center = TRUE, stars = c(0.001, 0.01, 0.05),
        bold = 0.05, caption = 'M1 = Fairness (DV), M2 = Team Work (DV), M3 = Want to work in team (DV), M4 = Distrust (DV)',
        caption.above = TRUE, digits = 3, leading.zero = F)
```

# Main Effects Analysis with control variables
## fairness
```{r, results=FALSE, warning=FALSE, message=FALSE}

m5 <- lme4::glmer(fairness ~ nonwhite_share*incomeShare_trial + age + gender + ethnic + edu + marital + children + employment + income_log + ladder + PoliticalOrientation+(1 | X), cd, family = binomial(link = "logit"))
```
```{r, echo=FALSE}
summary(m5)
```
### plot
```{r, include=FALSE}
fairness_maineffect <- interactions::interact_plot(m5, pred = nonwhite_share, modx = incomeShare_trial, x.label = "income share held by majority", y.label = "0 = fair, 1 = unfair", legend.main = "majority held by...") + ylim(c(0,1))

fairness_maineffect_annotated <- annotate_figure(fairness_maineffect,
               top = text_grob("Fairness by Condition", color = "black", face = "bold", size = 14)) 
ggsave(plot = fairness_maineffect_annotated, width = 8, height = 6, filename = "fairness_maineffect.jpg")
```
```{r}
knitr::include_graphics("fairness_maineffect.jpg")
```

## work in team
```{r, results=FALSE, warning=FALSE, message=FALSE}

m6 <- lme4::glmer(work_in_team ~ nonwhite_share*incomeShare_trial + age + gender + ethnic + edu + marital + children + employment + income_log + ladder + PoliticalOrientation+(1 | X), cd, family = binomial(link = "logit"))
```
```{r, echo=FALSE}
summary(m6)
```
### plot
```{r}
work_in_team_maineffect <- interactions::interact_plot(m6, pred = nonwhite_share, modx = incomeShare_trial, x.label = "income share held by majority", y.label = "0 = want to work in team, 1 = do not want to work in team", legend.main = "majority held by...") + ylim(c(0,1))

work_in_team_maineffect_annotated <- annotate_figure(work_in_team_maineffect,
               top = text_grob("Work in Team by Condition", color = "black", face = "bold", size = 14)) 
ggsave(plot = work_in_team_maineffect_annotated, width = 8, height = 6, filename = "work_in_team_maineffect.jpg")

```
```{r}
knitr::include_graphics("work_in_team_maineffect.jpg")
```

## team work
```{r, results=FALSE, warning=FALSE, message=FALSE}

m7 <- lme4::glmer(team_work ~ nonwhite_share*incomeShare_trial + age + gender + ethnic + edu + marital + children + employment + income_log + ladder + PoliticalOrientation+(1 | X), cd, family = binomial(link = "logit"))
```
```{r, echo=FALSE}
summary(m7)
```
### plot
```{r}
team_work_maineffect <- interactions::interact_plot(m7, pred = nonwhite_share, modx = incomeShare_trial, x.label = "income share held by majority", y.label = "0 = team work well, 1 = team work not well", legend.main = "majority held by...") + ylim(c(0,1))

team_work_maineffect_annotated <- annotate_figure(team_work_maineffect,
               top = text_grob("Team work by Condition", color = "black", face = "bold", size = 14)) 
ggsave(plot = work_in_team_maineffect_annotated, width = 8, height = 6, filename = "team_work_maineffect.jpg")

```
```{r}
knitr::include_graphics("team_work_maineffect.jpg")
```

## distrust of the organization’s leadership
```{r, results=FALSE, warning=FALSE, message=FALSE}

m8 <- lme4::glmer(distrust ~ nonwhite_share*incomeShare_trial + age + gender + ethnic + edu + marital + children + employment + income_log + ladder + PoliticalOrientation+(1 | X), cd, family = binomial(link = "logit"))
```
```{r, echo=FALSE}
summary(m8)
```
### plot
```{r}
distrust_maineffect <- interactions::interact_plot(m8, pred = nonwhite_share, modx = incomeShare_trial, x.label = "income share held by majority", y.label = "0 = distrust , 1 = no distrust", legend.main = "majority held by...") + ylim(c(0,1))

distrust_maineffect_annotated <- annotate_figure(distrust_maineffect,
               top = text_grob("Team work by Condition", color = "black", face = "bold", size = 14)) 
ggsave(plot = distrust_maineffect_annotated, width = 8, height = 6, filename = "distrust_maineffect.jpg")

```
```{r}
knitr::include_graphics("distrust_maineffect.jpg")
```

## Table
```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

htmlreg(l = list(m5, m6, m7, m8), center = TRUE, stars = c(0.001, 0.01, 0.05),
        bold = 0.05, caption = 'M1 = Fairness (DV), M2 = Want to work in team (DV), M3 = Trust org (DV)',
        caption.above = TRUE, digits = 3, leading.zero = F)
```

# Moderator Analysis: Political Orientation
## fairness
```{r}

summary(m1_1 <- lme4::glmer(fairness ~ PoliticalOrientation*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot1_1 <- interactions::interact_plot(m1_1, pred = incomeShare_trial, modx = PoliticalOrientation, x.label = "income share held by majority", y.label = "0 = fair, 1 = unfair", legend.main = "political orientation") + ylim(c(0,1))
```

## want to work in team
```{r}
summary(m2_1 <- lme4::glmer(work_in_team ~ PoliticalOrientation*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot2_1 <- interactions::interact_plot(m2_1, pred = incomeShare_trial, modx = PoliticalOrientation, x.label = "income share held by majority", y.label = "0 = want to work in team, 1 = do not want to work in team", legend.main = "political orientation") + ylim(c(0,1))
```

## team work
```{r}
summary(m3_1 <- lme4::glmer(team_work ~ PoliticalOrientation*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot3_1 <- interactions::interact_plot(m3_1, pred = incomeShare_trial, modx = PoliticalOrientation, x.label = "income share held by majority", y.label = "0 = team work well, 1 = team work not well", legend.main = "political orientation") + ylim(c(0,1))
```


## distrust
```{r}
summary(m4_1 <- lme4::glmer(distrust ~ PoliticalOrientation*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot4_1 <- interactions::interact_plot(m4_1, pred = incomeShare_trial, modx = PoliticalOrientation, x.label = "income share held by majority", y.label = "0 = distrust , 1 = no distrust", legend.main = "political orientation") + ylim(c(0,1))
```
``` {r}
interaction_polorientation <- ggarrange(plot1_1, plot2_1, plot3_1, plot4_1, ncol = 2, nrow = 2, common.legend = T)

ggsave(plot = interaction_polorientation, width = 10, height = 8, filename = "polorientation.jpg")
knitr::include_graphics("polorientation.jpg")
```


# Moderator Analysis: SDO
## fairness
```{r}

summary(m1_2 <- lme4::glmer(fairness ~ SDO *nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot1_2 <- interactions::interact_plot(m1_2, pred = incomeShare_trial, modx = SDO, x.label = "income share held by majority", y.label = "0 = fair, 1 = unfair", legend.main = "SDO") + ylim(c(0,1))
```

## want to work in team
```{r}
summary(m2_2 <- lme4::glmer(work_in_team ~ SDO*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot2_2 <- interactions::interact_plot(m2_2, pred = incomeShare_trial, modx = SDO, x.label = "income share held by majority", y.label = "0 = want to work in team, 1 = do not want to work in team", legend.main = "SDO") + ylim(c(0,1))
```

## team work
```{r}
summary(m3_2 <- lme4::glmer(team_work ~ SDO*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot3_2 <- interactions::interact_plot(m3_2, pred = incomeShare_trial, modx = SDO, x.label = "income share held by majority", y.label = "0 = team work well, 1 = team work not well", legend.main = "SDO") + ylim(c(0,1))
```


## distrust
```{r}
summary(m4_2 <- lme4::glmer(distrust ~ SDO*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot4_2 <- interactions::interact_plot(m4_2, pred = incomeShare_trial, modx = SDO, x.label = "income share held by majority", y.label = "0 = distrust , 1 = no distrust", legend.main = "SDO") + ylim(c(0,1))
```
``` {r}
interaction_SDO <- ggarrange(plot1_2, plot2_2, plot3_2, plot4_2, ncol = 2, nrow = 2, common.legend = T)

ggsave(plot = interaction_SDO, width = 10, height = 8, filename = "SDO.jpg")
knitr::include_graphics("SDO.jpg")
```


# Moderator Analysis: BJW
## fairness
```{r}

summary(m1_3 <- lme4::glmer(fairness ~ BJW *nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot1_3 <- interactions::interact_plot(m1_3, pred = incomeShare_trial, modx = BJW, x.label = "income share held by majority", y.label = "0 = fair, 1 = unfair", legend.main = "BJW") + ylim(c(0,1))
```

## want to work in team
```{r}
summary(m2_3 <- lme4::glmer(work_in_team ~ BJW*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot2_3 <- interactions::interact_plot(m2_3, pred = incomeShare_trial, modx = BJW, x.label = "income share held by majority", y.label = "0 = want to work in team, 1 = do not want to work in team", legend.main = "BJW") + ylim(c(0,1))
```

## team work
```{r}
summary(m3_3 <- lme4::glmer(team_work ~ BJW*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot3_3 <- interactions::interact_plot(m3_3, pred = incomeShare_trial, modx = BJW, x.label = "income share held by majority", y.label = "0 = team work well, 1 = team work not well", legend.main = "BJW") + ylim(c(0,1))
```


## distrust
```{r}
summary(m4_3 <- lme4::glmer(distrust ~ BJW*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot4_3 <- interactions::interact_plot(m4_3, pred = incomeShare_trial, modx = BJW, x.label = "income share held by majority", y.label = "0 = distrust , 1 = no distrust", legend.main = "BJW") + ylim(c(0,1))
```
``` {r}
interaction_BJW <- ggarrange(plot1_3, plot2_3, plot3_3, plot4_3, ncol = 2, nrow = 2, common.legend = T)

ggsave(plot = interaction_BJW, width = 10, height = 8, filename = "BJW.jpg")
knitr::include_graphics("BJW.jpg")
```

# Moderator Analysis: Race
## fairness
```{r}
summary(m1_4 <- lme4::glmer(fairness ~ ethnic *nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot1_4 <- interactions::interact_plot(m1_4, pred = incomeShare_trial, modx = ethnic, x.label = "income share held by majority", y.label = "0 = fair, 1 = unfair", legend.main = "ethnic") + ylim(c(0,1))
```

## want to work in team
```{r}
summary(m2_4 <- lme4::glmer(work_in_team ~ ethnic*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot2_4 <- interactions::interact_plot(m2_4, pred = incomeShare_trial, modx = ethnic, x.label = "income share held by majority", y.label = "0 = want to work in team, 1 = do not want to work in team", legend.main = "ethnic") + ylim(c(0,1))
```

## team work
```{r}
summary(m3_4 <- lme4::glmer(team_work ~ ethnic*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot3_4 <- interactions::interact_plot(m3_4, pred = incomeShare_trial, modx = ethnic, x.label = "income share held by majority", y.label = "0 = team work well, 1 = team work not well", legend.main = "ethnic") + ylim(c(0,1))
```


## distrust
```{r}
summary(m4_4 <- lme4::glmer(distrust ~ ethnic*nonwhite_share*incomeShare_trial +(1 | X), cd, family = binomial(link = "logit")))

plot4_4 <- interactions::interact_plot(m4_4, pred = incomeShare_trial, modx = ethnic, x.label = "income share held by majority", y.label = "0 = distrust , 1 = no distrust", legend.main = "ethnic") + ylim(c(0,1))
```
``` {r}
interaction_ethnic <- ggarrange(plot1_4, plot2_4, plot3_4, plot4_4, ncol = 2, nrow = 2, common.legend = T)

ggsave(plot = interaction_ethnic, width = 10, height = 8, filename = "ethnic.jpg")
knitr::include_graphics("ethnic.jpg")
```
